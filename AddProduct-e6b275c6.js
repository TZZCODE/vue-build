import{d as I,h as M,o as R,c as S,w as s,a as l,u as A,x as B,r,i as k,j as G,f as c,A as F,b as U,v as L,s as x,p as z,e as j,t as D,_ as E}from"./index-bbfac4a2.js";import{c as C}from"./config-efaa5831.js";import{u as H,P as J}from"./productList-b16de5ed.js";const K=I({__name:"Upload",setup(m){const _=M([]),a=()=>{},y=(g,i)=>{console.log(g,i)},b=g=>{};return(g,i)=>{const o=r("el-icon"),V=r("el-upload");return R(),S(V,{"file-list":_.value,"onUpdate:fileList":i[0]||(i[0]=P=>_.value=P),onAction:a,"list-type":"picture-card","on-preview":b,"on-remove":y},{default:s(()=>[l(o,null,{default:s(()=>[l(A(B))]),_:1})]),_:1},8,["file-list"])}}}),O=m=>(z("data-v-e85710b0"),m=m(),j(),m),Q={class:"nav"},W=O(()=>c("div",{class:"title"},"产品类型列表",-1)),X={class:"tree"},Y={class:"wrapper"},Z={class:"wrapper-title"},ee=I({__name:"AddProduct",setup(m){const _=L(),a=H(),y={label:"name",children:"zones",isLeaf:"leaf"};M();const b=(t,e)=>{console.log("node",t),t.level===0&&x.get(C.goodsType).then(u=>{e(u.data)}),t.level>=1&&x.get(C.goodsType,{type:t.data.cid}).then(u=>{e(u.data)})},g=(t,e)=>{console.log("data==",t,"node===",e),e.level>1&&(o.category=t.name)},i=M(),o=k({title:"",sellPoint:"",des:"",price:"",category:"",num:"",img:"",time:"",delivery:!1}),V=k({category:[{required:!0,message:"请在左侧选择商品类目",trigger:"blur"}],title:[{required:!0,message:"请输入商品名称",trigger:"blur"}],price:[{required:!0,message:"请输入商品价格",trigger:"blur"},{pattern:/^\+?[0-9]\d*$/,message:"商品价格不能小于0"}],num:[{required:!0,message:"请输入商品数量",trigger:"blur"},{pattern:/^\+?[0-9]\d*$/,message:"商品数量不能小于0"}]}),P=()=>{let{title:t,sellPoint:e,des:u,price:f,category:n,num:p}=o;x.get(C.addGoods,{title:decodeURI(t),sellPoint:decodeURI(e),des:decodeURI(u),price:f,category:decodeURI(n),num:p}).then(v=>{console.log(v.code),v.code===200&&(D({message:"商品添加成功",grouping:!0,type:"success"}),_.push("/product/list"))})},N=async t=>{t&&await t.validate((e,u)=>{console.log(o),e?P():console.log("error submit!",u)})},T=t=>{t&&t.resetFields()},$=()=>{_.push("/product/list")};return G(()=>{var t,e;a.pageType==J.Editor_Goods&&(o.title=a.goodsModel.title,o.sellPoint=((t=a.goodsModel)==null?void 0:t.sellPoint)??"",o.des=((e=a.goodsModel)==null?void 0:e.des)??"",o.price=a.goodsModel.price,o.category=a.goodsModel.category,o.num=a.goodsModel.num,o.time=a.goodsModel.time)}),(t,e)=>{const u=r("el-tree"),f=r("el-col"),n=r("el-form-item"),p=r("el-input"),v=r("el-switch"),w=r("el-button"),h=r("el-form"),q=r("el-row");return R(),S(q,{gutter:20},{default:s(()=>[l(f,{span:4},{default:s(()=>[c("div",Q,[W,c("div",X,[l(u,{props:y,load:b,accordion:"",lazy:"",onNodeClick:g})])])]),_:1}),l(f,{span:20},{default:s(()=>[c("div",Y,[c("div",Z,"商品"+F(A(a).title),1),c("div",null,[l(h,{ref_key:"ruleFormRef",ref:i,model:o,rules:V,"label-width":"100px",class:"demo-ruleForm","status-icon":""},{default:s(()=>[l(n,{label:"所属分类",prop:"category"},{default:s(()=>[c("span",null,F(o.category),1)]),_:1}),l(n,{label:"商品名称",prop:"title"},{default:s(()=>[l(p,{modelValue:o.title,"onUpdate:modelValue":e[0]||(e[0]=d=>o.title=d)},null,8,["modelValue"])]),_:1}),l(n,{label:"商品价格",prop:"price"},{default:s(()=>[l(p,{modelValue:o.price,"onUpdate:modelValue":e[1]||(e[1]=d=>o.price=d)},null,8,["modelValue"])]),_:1}),l(n,{label:"商品数量",prop:"num"},{default:s(()=>[l(p,{modelValue:o.num,"onUpdate:modelValue":e[2]||(e[2]=d=>o.num=d)},null,8,["modelValue"])]),_:1}),l(n,{label:"商品卖点",prop:"sellPoint"},{default:s(()=>[l(p,{modelValue:o.sellPoint,"onUpdate:modelValue":e[3]||(e[3]=d=>o.sellPoint=d)},null,8,["modelValue"])]),_:1}),l(n,{label:"商品描述",prop:"des"},{default:s(()=>[l(p,{modelValue:o.des,"onUpdate:modelValue":e[4]||(e[4]=d=>o.des=d)},null,8,["modelValue"])]),_:1}),l(n,{label:"上传图片",prop:"img"},{default:s(()=>[l(K)]),_:1}),l(n,{label:"是否推荐",prop:"delivery"},{default:s(()=>[l(v,{modelValue:o.delivery,"onUpdate:modelValue":e[5]||(e[5]=d=>o.delivery=d)},null,8,["modelValue"])]),_:1}),l(n,null,{default:s(()=>[l(w,{type:"primary",onClick:e[6]||(e[6]=d=>N(i.value))},{default:s(()=>[U(" 保存 ")]),_:1}),l(w,{onClick:e[7]||(e[7]=d=>T(i.value))},{default:s(()=>[U("重置")]),_:1}),l(w,{onClick:$},{default:s(()=>[U("取消")]),_:1})]),_:1})]),_:1},8,["model","rules"])])])]),_:1})]),_:1})}}});const se=E(ee,[["__scopeId","data-v-e85710b0"]]);export{se as default};
