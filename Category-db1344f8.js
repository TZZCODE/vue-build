import{d as U,h as _,i as j,j as q,o as B,g as A,f as u,a,w as o,u as p,F as D,s as C,r as f,p as R,e as G,b as r,A as H,c as J,x as K,B as O,z as P,y as Q,q as W,t as V,_ as X}from"./index-bbfac4a2.js";import{c as k}from"./config-efaa5831.js";const E=g=>(R("data-v-d0c36010"),g=g(),G(),g),Y={class:"container"},Z=E(()=>u("div",{class:"title"},"产品类目管理",-1)),ee={class:"custom-tree-node"},te=E(()=>u("strong",null,"请输入类目名称",-1)),ae={class:"dialog-footer"},le=U({__name:"Category",setup(g){let N=_({label:"name"});const i=_(!1);let m=_(""),s=_(""),d=j({type:1,data:{}});const b=_([{id:1,name:"一级1",children:[{id:4,name:"二级1-1"}]},{id:2,name:"一级2",children:[{id:5,name:"Level two 2-1"},{id:6,name:"Level two 2-2"}]}]),S=t=>{i.value=!1},y=()=>{C.get(k.category).then(t=>{let e=[],l=[];t.data.forEach(n=>{n.type=="1"?(n.children=[],e.push(n)):l.push(n)}),e.forEach(n=>{l.forEach(v=>{var h;v.type==n.cid&&((h=n.children)==null||h.push(v))})}),b.value=e})};q(()=>{y()});const z=()=>{s.value="",i.value=!0,m.value="新增一级类目",d.type=0},I=t=>{s.value="",i.value=!0,m.value=`新增【${t.name}】的子级分类`,d.data=t,d.type=1},$=(t,e)=>{console.log("node===",t,"data===",e),i.value=!0,d.data=e,m.value=`修改【${e.name}】名称`,d.type=2,s.value=e.name},F=(t,e)=>{C.get(k.deleteCategory,{id:e.id,type:e.type,cid:e.cid}).then(l=>{l.code==200&&(V({message:l.msg,grouping:!0,type:"success"}),y())})},L=()=>{i.value=!1},M=()=>{i.value=!1,d.type==1||d.type==0?C.get(k.addCtegory,{name:s.value,cid:d.data.cid}).then(t=>{console.log(t),t.code==200&&(V({message:"类目添加成功",grouping:!0,type:"success"}),y())}):C.get(k.updataCtegory,{name:s.value,id:d.data.id}).then(t=>{console.log(t),t.code==200&&V({message:"类目修改成功",grouping:!0,type:"success"}),y()})};return(t,e)=>{const l=f("el-button"),n=f("el-icon"),v=f("el-tree"),h=f("el-input"),T=f("el-dialog");return B(),A(D,null,[u("div",Y,[Z,a(l,{class:"elbtn",type:"warning",onClick:z},{default:o(()=>[r("新增一级导航类目")]),_:1}),a(v,{data:b.value,"show-checkbox":"","node-key":"id",props:p(N),"default-expand-all":"","expand-on-click-node":!1},{default:o(({node:c,data:x})=>[u("span",ee,[u("span",null,H(c.label),1),u("span",null,[c.level==1?(B(),J(l,{key:0,size:"small",onClick:w=>I(x)},{default:o(()=>[a(n,null,{default:o(()=>[a(p(K))]),_:1}),r(" 新增 ")]),_:2},1032,["onClick"])):O("",!0),a(l,{size:"small",style:{"margin-left":"8px"},onClick:w=>$(c,x)},{default:o(()=>[a(n,null,{default:o(()=>[a(p(P))]),_:1}),r(" 修改 ")]),_:2},1032,["onClick"]),a(l,{type:"danger",size:"small",style:{"margin-left":"8px"},onClick:w=>F(c,x)},{default:o(()=>[a(n,null,{default:o(()=>[a(p(Q))]),_:1}),r(" 删除 ")]),_:2},1032,["onClick"])])])]),_:1},8,["data","props"])]),a(T,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=c=>i.value=c),title:p(m),width:"30%","before-close":S},{footer:o(()=>[u("span",ae,[a(l,{onClick:L},{default:o(()=>[r("取消")]),_:1}),a(l,{type:"primary",onClick:M},{default:o(()=>[r(" 确定 ")]),_:1})])]),default:o(()=>[te,a(h,{class:"dia-input",modelValue:p(s),"onUpdate:modelValue":e[0]||(e[0]=c=>W(s)?s.value=c:s=c),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1},8,["modelValue","title"])],64)}}});const se=X(le,[["__scopeId","data-v-d0c36010"]]);export{se as default};
