import{d as I,n as C,o as R,c as S,w as s,a as l,u as A,D as h,r,v as M,x as G,f as c,t as F,b as U,k as L,A as x,B as k,p as z,e as D,E,_ as j}from"./index-9e02f54d.js";import{u as H,P as J}from"./productList-7357737d.js";const K=I({__name:"Upload",setup(m){const _=C([]),d=()=>{},y=(f,i)=>{console.log(f,i)},b=f=>{};return(f,i)=>{const o=r("el-icon"),V=r("el-upload");return R(),S(V,{"file-list":_.value,"onUpdate:fileList":i[0]||(i[0]=P=>_.value=P),onAction:d,"list-type":"picture-card","on-preview":b,"on-remove":y},{default:s(()=>[l(o,null,{default:s(()=>[l(A(h))]),_:1})]),_:1},8,["file-list"])}}}),O=m=>(z("data-v-afdbaa99"),m=m(),D(),m),Q={class:"nav"},W=O(()=>c("div",{class:"title"},"产品类型列表",-1)),X={class:"tree"},Y={class:"wrapper"},Z={class:"wrapper-title"},ee=I({__name:"AddProduct",setup(m){const _=L(),d=H(),y={label:"name",children:"zones",isLeaf:"leaf"};C();const b=(t,e)=>{console.log("node",t),t.level===0&&x.get(k.goodsType).then(u=>{e(u.data)}),t.level>=1&&x.get(k.goodsType,{type:t.data.cid}).then(u=>{e(u.data)})},f=(t,e)=>{console.log("data==",t,"node===",e),e.level>1&&(o.category=t.name)},i=C(),o=M({title:"",sellPoint:"",des:"",price:"",category:"",num:"",img:"",time:"",delivery:!1}),V=M({category:[{required:!0,message:"请在左侧选择商品类目",trigger:"blur"}],title:[{required:!0,message:"请输入商品名称",trigger:"blur"}],price:[{required:!0,message:"请输入商品价格",trigger:"blur"},{pattern:/^\+?[0-9]\d*$/,message:"商品价格不能小于0"}],num:[{required:!0,message:"请输入商品数量",trigger:"blur"},{pattern:/^\+?[0-9]\d*$/,message:"商品数量不能小于0"}]}),P=()=>{let{title:t,sellPoint:e,des:u,price:g,category:n,num:p}=o;x.get(k.addGoods,{title:decodeURI(t),sellPoint:decodeURI(e),des:decodeURI(u),price:g,category:decodeURI(n),num:p}).then(v=>{console.log(v.code),v.code===200&&(E({message:"商品添加成功",grouping:!0,type:"success"}),_.push("/product/list"))})},N=async t=>{t&&await t.validate((e,u)=>{console.log(o),e?P():console.log("error submit!",u)})},T=t=>{t&&t.resetFields()},$=()=>{_.push("/product/list")};return G(()=>{var t,e;d.pageType==J.Editor_Goods&&(o.title=d.goodsModel.title,o.sellPoint=((t=d.goodsModel)==null?void 0:t.sellPoint)??"",o.des=((e=d.goodsModel)==null?void 0:e.des)??"",o.price=d.goodsModel.price,o.category=d.goodsModel.category,o.num=d.goodsModel.num,o.time=d.goodsModel.time)}),(t,e)=>{const u=r("el-tree"),g=r("el-col"),n=r("el-form-item"),p=r("el-input"),v=r("el-switch"),w=r("el-button"),q=r("el-form"),B=r("el-row");return R(),S(B,{gutter:20},{default:s(()=>[l(g,{span:4},{default:s(()=>[c("div",Q,[W,c("div",X,[l(u,{props:y,load:b,accordion:"",lazy:"",onNodeClick:f})])])]),_:1}),l(g,{span:20},{default:s(()=>[c("div",Y,[c("div",Z,"商品"+F(A(d).title),1),c("div",null,[l(q,{ref_key:"ruleFormRef",ref:i,model:o,rules:V,"label-width":"100px",class:"demo-ruleForm","status-icon":""},{default:s(()=>[l(n,{label:"所属分类",prop:"category"},{default:s(()=>[c("span",null,F(o.category),1)]),_:1}),l(n,{label:"商品名称",prop:"title"},{default:s(()=>[l(p,{modelValue:o.title,"onUpdate:modelValue":e[0]||(e[0]=a=>o.title=a)},null,8,["modelValue"])]),_:1}),l(n,{label:"商品价格",prop:"price"},{default:s(()=>[l(p,{modelValue:o.price,"onUpdate:modelValue":e[1]||(e[1]=a=>o.price=a)},null,8,["modelValue"])]),_:1}),l(n,{label:"商品数量",prop:"num"},{default:s(()=>[l(p,{modelValue:o.num,"onUpdate:modelValue":e[2]||(e[2]=a=>o.num=a)},null,8,["modelValue"])]),_:1}),l(n,{label:"商品卖点",prop:"sellPoint"},{default:s(()=>[l(p,{modelValue:o.sellPoint,"onUpdate:modelValue":e[3]||(e[3]=a=>o.sellPoint=a)},null,8,["modelValue"])]),_:1}),l(n,{label:"商品描述",prop:"des"},{default:s(()=>[l(p,{modelValue:o.des,"onUpdate:modelValue":e[4]||(e[4]=a=>o.des=a)},null,8,["modelValue"])]),_:1}),l(n,{label:"上传图片",prop:"img"},{default:s(()=>[l(K)]),_:1}),l(n,{label:"是否推荐",prop:"delivery"},{default:s(()=>[l(v,{modelValue:o.delivery,"onUpdate:modelValue":e[5]||(e[5]=a=>o.delivery=a)},null,8,["modelValue"])]),_:1}),l(n,null,{default:s(()=>[l(w,{type:"primary",onClick:e[6]||(e[6]=a=>N(i.value))},{default:s(()=>[U(" 保存 ")]),_:1}),l(w,{onClick:e[7]||(e[7]=a=>T(i.value))},{default:s(()=>[U("重置")]),_:1}),l(w,{onClick:$},{default:s(()=>[U("取消")]),_:1})]),_:1})]),_:1},8,["model","rules"])])])]),_:1})]),_:1})}}});const te=j(ee,[["__scopeId","data-v-afdbaa99"]]);export{te as default};
